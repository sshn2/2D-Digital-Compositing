# WEEK 08
## Keying
<img width="977" alt="스크린샷 2023-01-03 오전 1 15 20" src="https://user-images.githubusercontent.com/112941366/210256467-429ec138-60b9-420e-b9f7-92abcb965831.png">

키잉은 컴포지팅 시스템이 이미지에서 다양한 색상을 찾도록 요청하여 매트(전경 영역을 정의하는 이미지)를 만드는 프로세스이다. 이를 키 추출이라고도 한다. 그러나 단색 화면 앞에 전경 개체를 배치해야 하기 때문에 키잉을 위해 특별히 촬영해야 한다. 컴퓨터에서 이 색상을 제거하라는 메시지가 표시되기 때문에 화면 색상에는 전경 개체의 색상이 포함될 수 없다. 일반적으로 이 작업은 각각 블루스크린 또는 그린스크린 이라고 하는 파란색 또는 녹색 배경으로 수행된다. 일반적으로 선택한 색상은 관련이 있습니다. 그린스크린에서 키를 추출하는 것은 모든 컴포지터의 기본 기술 중 하나이지만 숙련된 아티스트만이 추출된 그린 스크린 요소를 다른 CG 레이어와 통합하여 동시에 촬영된 것처럼 보이게 만들 수 있다. 같은 조명 아래 같은 카메라와 렌즈를 사용하더라도, 컴포지터의 경우 녹색 픽셀과 알파 채널보다 더 많은 것을 볼 수 있다. 그린 스크린이나 블루 스크린의 정교함은 섬세한 예술적 안목과 방법론적 사고를 모두 필요로 한다.

## Soft key, Hard Key + Keymix
- 키 하나만 사용할 필요는 없다.
- 키를 눌러도 좋은 결과가 나오지 않으면 다른 것을 시도하고 다른 것을 시도하고 또 다른 것을 시도한다.
- 그리고 우리는 다양한 부품에 키를 섞을 수 있다.
- 조명 이슈, 헤어 디테일 등에 대하여
- 기억하세요: 우리는 깨끗한 매트를 뽑기 위해 키를 사용한다.

소프트 키, 하드 키 기법은 서로 다른 내부 키와 외부 키를 결합하여 우버 키를 구축한다. 이것은 다른 유형의 키어이거나 다른 조정이 있는 동일한 키어일 수 있다. 우리가 여기 있는 동안 휘도가 조정된 디스필를 추가한 다음 AddMix 컴포지트로 마무리하여 약간 혼합한다. 소프트 키의 경우 Keylight는 항상 부드러운 가장자리에 적합하고 견고한 코어에는 적합하지 않다. 그래서 우리는 이것을 가장자리 키로 사용하고 그것에서 가비지 매트를 만든다. 이를 위해 이전 Erode 노드를 사용하고 다시 Erode Blur만 사용한다. 

hard key에서 key light과 filtererode를 통하여 인물의 누끼를 따준다. soft key에서는 keymix와 roto를 이용하여 배경을 정리하고 channelmerge를 통하여 인물의 누끼와 검은배경을 합친다. soft key는 외곽부분의 soft하게 잡는 것, hard key는 내부를 채우는 것 + keymix를 사용하여 연결한다.

## Despill
이 단계는 빛 자체의 특성 때문에 필요하다. 녹색 화면을 볼 수 있는 유일한 방법은 녹색 파장 내의 빛이 눈으로 이동하기 때문이다. 그것이 당신의 눈으로 이동한다면 캐릭터의 머리카락, 피부, 옷을 가로질러 이동해야 한다. 영상을 유출하고 이 문제를 제거하는 방법에는 여러 가지가 있지만 가장 간단한 방법은 두 가지 형태입니다.

1. 공통 키어에 내장된 디스필 도구가 있다. 예를 들어, primatte 에서 유출 스폰지는 배경색에 따라 샘플링된 영역에서 유출을 제거하려는 도구이다. Keylight는 빠르고 더러운 유출을 위한 더 간단한 트릭을 제공한다. 배경색에 대해 채널 값을 "1"로 설정한다. 녹색 화면의 경우 노드가 장면 전체에서 녹색 값을 낮추는 것을 볼 수 있다. 일반적으로 적갈색 배경이 남는다. 샷의 모든 색상에 영향을 미치므로 이 옵션을 조심해서 사용해야 한다.
2. 배경에 해당하는 채널의 값을 약화시키는 데 사용할 수 있는 기본 디스필 표현이 있다. 두 가지 일반적인 디스필 표현은 g > r ? r : g 및 g > (r+b)/2 ? (r+b)/2 : g. 첫 번째 식에서 녹색 값이 빨간색보다 크면 녹색 값이 빨간색 값으로 설정된다. 두 번째 표현식에서 녹색 값이 빨간색과 파란색의 평균보다 크면 빨간색과 파란색의 평균으로 설정된다. 

인물을 배경과 분리했다면 despill을 사용해야하는데 gizmo node를 통해서 인물에 묻은 그린을 회색으로 바꾼다. 초록 배경 억제로 인한 인물에 손상이 생긴다면 color correction을 해주어야 한다.

![image](https://user-images.githubusercontent.com/112941366/210258812-9361c387-c351-4ece-b684-95505e89295a.png)

---

### 출처

https://compositingmentor.com/2014/04/12/advanced-keying-breakdown-series-introduction/

https://www.actionvfx.com/blog/beginner-tips-for-keying-in-nuke-pt-2

https://learn.foundry.com/nuke/content/comp_environment/keying_with_keylight/basic_keying.html










